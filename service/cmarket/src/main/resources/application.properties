spring.application.name=cmarket_api

# JWT 설정 (보안: 환경 변수로 관리 필수)
# ⚠️ CRITICAL: 운영 환경에서는 반드시 환경 변수로 주입해야 합니다.
# HS256 알고리즘에 적합한 32바이트 이상의 임의 문자열 사용
jwt.secret=${JWT_SECRET:your-secret-key-must-be-at-least-256-bits-long-for-hmac-sha-algorithms-please-change-this-in-production}
jwt.access-token-validity-in-seconds=21600
jwt.refresh-token-validity-in-seconds=604800

# 이메일 설정
# 개발 환경: 실제 이메일 발송 없이 로그만 출력 (spring.mail.host를 설정하지 않으면 MockMailSender 사용)
# 운영 환경: 실제 SMTP 서버 설정 필요

# 개발 환경용 (실제 이메일 발송 안 함 - 로그만 출력)
# spring.mail.host=smtp.gmail.com
# spring.mail.port=587
# spring.mail.username=your-email@gmail.com
# spring.mail.password=your-app-password
# spring.mail.properties.mail.smtp.auth=true
# spring.mail.properties.mail.smtp.starttls.enable=true

# 운영 환경용 (실제 SMTP 서버 사용 시 위 주석 해제하고 설정)
# Gmail 사용 시: Google 계정 > 보안 > 2단계 인증 활성화 > 앱 비밀번호 생성 필요

# H2 (파일 기반 - 서버 재시작 시에도 데이터 유지)
# Docker 볼륨 마운트 경로로 변경
spring.datasource.url=jdbc:h2:file:/data/cmarket;DB_CLOSE_DELAY=-1
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=

spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

# JPA
# ⚠️ 주의: 개발 단계에서는 편리하지만, 운영 환경에서는 validate 또는 none 고려
# update: 개발 환경용 (스키마 자동 변경)
# validate: 스키마 검증만 수행 (운영 환경 권장)
# none: 스키마 관리 안 함
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.H2Dialect

# SQL 초기화 설정
# ⚠️ 주의: 파일 기반 H2 사용 시 재시작마다 실행되면 중복 데이터/에러 발생 가능
# always: 매번 실행 (인메모리 DB용, 초기 데이터 구축 시에만 사용)
# never: 실행 안 함 (파일 기반 DB에서 초기 데이터가 이미 있는 경우, 배포 환경 권장)
# embedded: 임베디드 DB에서만 실행
# 배포 환경에서는 never로 변경 권장 (초기 데이터 구축 완료 후)
spring.sql.init.mode=always
spring.jpa.defer-datasource-initialization=true

# OAuth2
# ⚠️ CRITICAL: Client Secret이 코드에 노출되면 보안 사고로 이어질 수 있습니다.
# 반드시 환경 변수로 관리하거나 배포 시에만 주입해야 합니다.
# Google OAuth2
spring.security.oauth2.client.registration.google.client-id=${GOOGLE_CLIENT_ID:13269763480-a40nju0rfr3qu3hjgg13b4j010k6562c.apps.googleusercontent.com}
spring.security.oauth2.client.registration.google.client-secret=${GOOGLE_CLIENT_SECRET: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}
spring.security.oauth2.client.registration.google.scope=profile,email
spring.security.oauth2.client.registration.google.redirect-uri={baseUrl}/login/oauth2/code/{registrationId}

# ??? OAuth2
spring.security.oauth2.client.registration.kakao.client-id=your-kakao-client-id
spring.security.oauth2.client.registration.kakao.client-secret=your-kakao-client-secret
spring.security.oauth2.client.registration.kakao.authorization-grant-type=authorization_code
spring.security.oauth2.client.registration.kakao.redirect-uri={baseUrl}/login/oauth2/code/{registrationId}
spring.security.oauth2.client.registration.kakao.scope=profile_nickname,account_email
spring.security.oauth2.client.registration.kakao.client-name=Kakao
spring.security.oauth2.client.provider.kakao.authorization-uri=https://kauth.kakao.com/oauth/authorize
spring.security.oauth2.client.provider.kakao.token-uri=https://kauth.kakao.com/oauth/token
spring.security.oauth2.client.provider.kakao.user-info-uri=https://kapi.kakao.com/v2/user/me
spring.security.oauth2.client.provider.kakao.user-name-attribute=id

# OAuth2 리다이렉트 URL (환경 변수로 관리, 기본값은 기존 값 유지)
# Docker 배포: 환경 변수 OAUTH2_REDIRECT_URI로 설정
oauth2.redirect-uri=${OAUTH2_REDIRECT_URI:http://localhost:5173/oauth-redirect}

# 이미지 업로드 설정 (Docker 볼륨 마운트 경로)
# Dockerfile: RUN mkdir -p /data/uploads/images
# docker-compose.yml: - ./uploads:/data/uploads
# 경로 확인: /data/uploads/images (docker-compose.yml의 /data/uploads와 일치)
app.image.upload-dir=/data/uploads/images
app.image.base-url=/api/images
# 서버의 완전한 URL (환경 변수로 관리, 기본값은 기존 값 유지)
# 로컬 개발: http://localhost:8080
# 네트워크 접근: http://192.168.45.25:8080
# Docker 배포: 환경 변수 APP_IMAGE_SERVER_URL로 설정
app.image.server-url=${APP_IMAGE_SERVER_URL:http://localhost:8080}

# 멀티파트 업로드 제한
spring.servlet.multipart.max-file-size=5MB
spring.servlet.multipart.max-request-size=5MB

# Redis 설정 (Docker Compose 서비스 이름으로 변경)
spring.data.redis.host=redis
spring.data.redis.port=6379
# spring.data.redis.password=your-redis-password  # 운영 환경에서 설정

# 채팅 관련 설정
chat.redis.ttl-days=30

